#:kivy 2.2.1

<TodoItem>:
    orientation: 'horizontal'
    size_hint_y: None
    height: dp(50)
    padding: dp(10)
    spacing: dp(10)

    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(5)]

    CheckBox:
        id: checkbox
        size_hint_x: None
        width: dp(40)
        active: root.todo_data.get('completed', False)
        on_active: root.on_checkbox_active(self.active)

    Label:
        id: title_label
        text: root.todo_data.get('title', '')
        font_size: sp(16)
        color: (0.5, 0.5, 0.5, 1) if root.todo_data.get('completed', False) else (0.2, 0.2, 0.2, 1)
        text_size: self.size
        halign: 'left'
        valign: 'center'
        strikethrough: root.todo_data.get('completed', False)

    Button:
        text: 'Âà†Èô§'
        size_hint_x: None
        width: dp(80)
        background_color: 0.96, 0.26, 0.21, 1
        background_normal: ''
        on_press: root.on_delete()


<TodoListScreen>:
    orientation: 'vertical'
    padding: dp(20)
    spacing: dp(15)

    canvas.before:
        Color:
            rgba: 0.96, 0.96, 0.96, 1
        Rectangle:
            pos: self.pos
            size: self.size

    # Ê†áÈ¢ò
    Label:
        text: 'üìù Todo List'
        font_size: sp(32)
        bold: True
        color: 0.2, 0.2, 0.2, 1
        size_hint_y: None
        height: dp(60)

    # ËæìÂÖ•Âå∫Âüü
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: dp(50)
        spacing: dp(10)

        TextInput:
            id: todo_input
            hint_text: 'ËæìÂÖ•Êñ∞‰ªªÂä°...'
            font_size: sp(16)
            multiline: False
            background_color: 1, 1, 1, 1
            foreground_color: 0.2, 0.2, 0.2, 1
            padding: [dp(15), dp(15)]
            on_text_validate: root.add_todo()

        Button:
            text: 'Ê∑ªÂä†'
            size_hint_x: None
            width: dp(100)
            font_size: sp(16)
            bold: True
            background_color: 0.3, 0.69, 0.31, 1
            background_normal: ''
            on_press: root.add_todo()

    # ‰ªªÂä°ÂàóË°®Ôºà‰ΩøÁî® ScrollViewÔºâ
    ScrollView:
        do_scroll_x: False
        do_scroll_y: True

        BoxLayout:
            id: todo_container
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            spacing: dp(5)

    # ÁªüËÆ°‰ø°ÊÅØÂíåÊìç‰Ωú
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: dp(40)
        spacing: dp(10)

        Label:
            id: stats_label
            text: 'ÊÄªËÆ°: 0 | ËøõË°å‰∏≠: 0 | Â∑≤ÂÆåÊàê: 0'
            font_size: sp(14)
            color: 0.4, 0.4, 0.4, 1
            halign: 'left'
            valign: 'center'
            text_size: self.size

        Button:
            text: 'Ê∏ÖÈô§Â∑≤ÂÆåÊàê'
            size_hint_x: None
            width: dp(120)
            font_size: sp(14)
            background_color: 0.6, 0.6, 0.6, 1
            background_normal: ''
            on_press: root.clear_completed()
